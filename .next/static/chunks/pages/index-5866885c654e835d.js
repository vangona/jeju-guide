(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{4620:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});var s=t(7876),n=t(4232),l=t(1772),i=t(1041);let r=e=>{let{place:a,size:t="medium",showLabel:r=!1,onUpdate:o,onRemoveConfirm:c}=e,[d,p]=(0,n.useState)(!1),[m,x]=(0,n.useState)(!1);(0,n.useEffect)(()=>{let e=localStorage.getItem("micheltain_myplace");e&&p(JSON.parse(e).some(e=>e.name===a.name))},[a.name]);let h=async()=>{if(d){if(c&&!await c(a))return;let e=localStorage.getItem("micheltain_myplace");if(e){let t=JSON.parse(e).filter(e=>e.name!==a.name);localStorage.setItem("micheltain_myplace",JSON.stringify(t)),p(!1),null==o||o()}}else{let e=localStorage.getItem("micheltain_myplace"),t=e?JSON.parse(e):[];t.some(e=>e.name===a.name)||(localStorage.setItem("micheltain_myplace",JSON.stringify([...t,a])),p(!0),x(!0),null==o||o(),setTimeout(()=>x(!1),600))}},u=()=>d?"저장됨":"여행 계획에 추가";return(0,s.jsxs)("button",{className:(()=>{let e="add-my-place-btn";return e+=" add-my-place-btn--".concat(t),d&&(e+=" add-my-place-btn--added"),m&&(e+=" add-my-place-btn--animating"),e})(),onClick:h,"aria-label":d?"여행 계획에서 제거":"여행 계획에 추가",title:u(),children:[(0,s.jsx)(l.g,{icon:m?i.e68:d?i.qcK:i.QLR}),r&&(0,s.jsx)("span",{className:"add-my-place-label",children:u()})]})}},5046:(e,a,t)=>{"use strict";t.d(a,{A:()=>c});var s=t(7876),n=t(4232),l=t(8230),i=t.n(l),r=t(1772),o=t(1041);let c=e=>{let{handleViewTypeChange:a}=e,[t,l]=(0,n.useState)("지도"),c=e=>{switch(l(e),e){case"지도":a("지도");break;case"목록":a("목록")}},d=[{key:"지도",label:"Map",icon:o.e5w},{key:"목록",label:"List",icon:o.ITF}];return(0,s.jsxs)("nav",{className:"nav__container",children:[d.map(e=>(0,s.jsxs)("button",{className:"nav__component ".concat(t===e.key?"nav__component--active":""),onClick:()=>c(e.key),"aria-label":e.label,children:[(0,s.jsx)(r.g,{icon:e.icon}),(0,s.jsx)("span",{className:"nav__label",children:e.label})]},e.key)),(0,s.jsxs)(i(),{href:"/myplace",className:"nav__component nav__component--link",children:[(0,s.jsx)(r.g,{icon:o.qcK}),(0,s.jsx)("span",{className:"nav__label",children:"My"})]}),(0,s.jsxs)(i(),{href:"/tips",className:"nav__component nav__component--link",children:[(0,s.jsx)(r.g,{icon:o.rC2}),(0,s.jsx)("span",{className:"nav__label",children:"Tips"})]})]})}},6760:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(7024)}])},6956:e=>{e.exports={aiChatModal:"AIChat_aiChatModal__5mCpX",fadeIn:"AIChat_fadeIn__rXlid",aiChatContainer:"AIChat_aiChatContainer__7ZEnB",aiChatHeader:"AIChat_aiChatHeader__ONKhh",aiChatMessages:"AIChat_aiChatMessages__FqdbR",aiChatInputForm:"AIChat_aiChatInputForm__GFWJ2",markdownContent:"AIChat_markdownContent__3U_1t",pulse:"AIChat_pulse__HXU0d"}},7024:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>L});var s=t(7876),n=t(3576),l=t(4232),i=t(8230),r=t.n(i),o=t(1772),c=t(1041);let d=e=>{let{postsPerPage:a,totalPosts:t,currentPage:n,handlePageChange:l}=e,i=[],r=Math.ceil(t/parseInt(a));for(let e=1;e<=r;e++)i.push(e);return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{className:"pagination__container",children:[1!==n&&(0,s.jsx)("span",{className:"pagination__arrow",onClick:()=>l(n-1),children:"◀"}),i.map(e=>(0,s.jsx)("span",{className:"pagination__index",onClick:()=>l(e),children:e},e)),n!==r&&(0,s.jsx)("span",{className:"pagination__arrow",onClick:()=>l(n+1),children:"▶"})]})})};var p=t(4620);let m=e=>{let{places:a,isMobile:t}=e,[n,i]=(0,l.useState)(""),[m,x]=(0,l.useState)("전체"),[h,u]=(0,l.useState)(1),[g,j]=(0,l.useState)("12"),[_,v]=(0,l.useState)("cards");(0,l.useEffect)(()=>(document.body.style.overflow="auto",document.body.classList.add("list__page-active"),()=>{document.body.style.overflow="hidden",document.body.classList.remove("list__page-active")}),[]);let y=h*parseInt(g),f=y-parseInt(g),b=a.filter(e=>{let a=e.type===m||"전체"===m,t=e.name.includes(n)||e.addressDetail.includes(n)||e.description.includes(n);return a&&t}),w=b.slice(f,y);return(0,s.jsxs)("div",{className:"list__container",children:[(0,s.jsxs)("div",{className:"list__header",children:[(0,s.jsxs)("div",{className:"list__title",children:[(0,s.jsx)(o.g,{icon:c.pch}),(0,s.jsx)("h2",{children:"장소 목록"}),(0,s.jsxs)("span",{className:"list__count",children:[b.length,"개 장소"]})]}),(0,s.jsxs)("div",{className:"list__controls",children:[(0,s.jsx)("div",{className:"list__search",children:(0,s.jsxs)("div",{className:"search__input-wrapper",children:[(0,s.jsx)(o.g,{icon:c.MjD,className:"search__icon"}),(0,s.jsx)("input",{className:"search__input",type:"text",onChange:e=>{let{target:{value:a}}=e;i(a)},value:n,placeholder:"장소명, 주소, 설명 검색..."})]})}),(0,s.jsxs)("div",{className:"list__filters",children:[(0,s.jsxs)("div",{className:"filter__group",children:[(0,s.jsx)(o.g,{icon:c.mRM}),(0,s.jsxs)("select",{className:"filter__select",name:"input__place-type",onChange:e=>{let{target:{value:a}}=e;x(a)},value:m,children:[(0,s.jsx)("option",{value:"전체",children:"전체"}),(0,s.jsx)("option",{value:"맛집",children:"맛집"}),(0,s.jsx)("option",{value:"카페 & 베이커리",children:"카페 & 베이커리"}),(0,s.jsx)("option",{value:"풍경",children:"풍경"}),(0,s.jsx)("option",{value:"술집",children:"술집"}),(0,s.jsx)("option",{value:"숙소",children:"숙소"}),(0,s.jsx)("option",{value:"그 외 가볼만한 곳",children:"그 외 가볼만한 곳"})]})]}),!t&&(0,s.jsxs)("div",{className:"filter__group",children:[(0,s.jsx)(o.g,{icon:c.OM7}),(0,s.jsxs)("select",{className:"filter__select",onChange:e=>{let{target:{value:a}}=e;j(a)},value:g,children:[(0,s.jsx)("option",{value:"6",children:"6개씩"}),(0,s.jsx)("option",{value:"12",children:"12개씩"}),(0,s.jsx)("option",{value:"24",children:"24개씩"})]})]}),(0,s.jsx)("button",{className:"view__toggle",onClick:()=>{v("cards"===_?"table":"cards")},title:"cards"===_?"테이블 보기":"카드 보기",children:(0,s.jsx)(o.g,{icon:"cards"===_?c.pch:c.l9V})})]})]})]}),(0,s.jsx)("div",{className:"list__content",children:0===b.length?(0,s.jsxs)("div",{className:"list__empty",children:[(0,s.jsx)(o.g,{icon:c.MjD}),(0,s.jsx)("h3",{children:"검색 결과가 없습니다"}),(0,s.jsx)("p",{children:"다른 검색어나 필터를 시도해보세요."})]}):(0,s.jsxs)(s.Fragment,{children:["cards"===_?(0,s.jsx)("div",{className:"list__cards-grid",children:w.map((e,a)=>(0,s.jsxs)("div",{className:"place__card",children:[(0,s.jsxs)("div",{className:"place__card-header",children:[(0,s.jsx)("h3",{className:"place__name",children:(0,s.jsx)(r(),{href:"/detail/".concat(e.name),children:e.name})}),(0,s.jsxs)("span",{className:"place__type",children:[(0,s.jsx)(o.g,{icon:c._2z}),e.type]})]}),e.attachmentUrlArray&&e.attachmentUrlArray.length>0&&(0,s.jsx)("div",{className:"place__image",children:(0,s.jsx)("img",{src:e.attachmentUrlArray[0],alt:e.name,loading:"lazy"})}),(0,s.jsxs)("div",{className:"place__content",children:[(0,s.jsxs)("div",{className:"place__address",children:[(0,s.jsx)(o.g,{icon:c.Pcr}),(0,s.jsx)("span",{children:e.addressDetail})]}),(0,s.jsx)("p",{className:"place__description",children:e.description.length>100?"".concat(e.description.slice(0,100),"..."):e.description})]}),(0,s.jsxs)("div",{className:"place__actions",children:[(0,s.jsxs)(r(),{href:"/detail/".concat(e.name),className:"place__detail-btn",children:[(0,s.jsx)(o.g,{icon:c.pS3}),"자세히 보기"]}),(0,s.jsx)(p.A,{place:e,size:"medium",showLabel:!1})]})]},e.id||a))}):(0,s.jsx)("div",{className:"list__table-container",children:(0,s.jsxs)("table",{className:"list__table",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"이름"}),(0,s.jsx)("th",{children:"주소"}),!t&&(0,s.jsx)("th",{children:"설명"}),(0,s.jsx)("th",{children:"액션"})]})}),(0,s.jsx)("tbody",{children:w.map((e,a)=>(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"list__table-name list__table-content",children:[(0,s.jsx)(r(),{href:"/detail/".concat(e.name),children:e.name}),(0,s.jsxs)("span",{className:"table__type",children:[(0,s.jsx)(o.g,{icon:c._2z}),e.type]})]}),(0,s.jsxs)("td",{className:"list__table-content",children:[(0,s.jsx)(o.g,{icon:c.Pcr}),e.addressDetail]}),!t&&(0,s.jsx)("td",{className:"list__table-content",children:e.description.length>50?"".concat(e.description.slice(0,50),"..."):e.description}),(0,s.jsx)("td",{className:"list__add-place-cell",children:(0,s.jsx)(p.A,{place:e,size:"small",showLabel:!1})})]},e.id||a))})]})}),(0,s.jsx)(d,{postsPerPage:g,totalPosts:b.length,currentPage:h,handlePageChange:e=>{u(e)}})]})})]})};var x=t(8312),h=t(5665);let u=e=>{let{latitude:a,longitude:t}=e,[n,i]=(0,l.useState)(""),r=async e=>{if(a){e.preventDefault();let s={text:n,createdAt:Date.now(),location:[a,t]};await (0,h.gS)((0,h.rJ)(x.C5,"chats"),s),i("")}else alert("먼저 위치를 표시해주세요.")};return(0,s.jsx)("div",{className:"saychat__container",children:(0,s.jsxs)("form",{className:"saycht__form",onSubmit:r,children:[(0,s.jsx)("textarea",{className:"saychat__content",value:n,onChange:e=>{let{target:{value:a}}=e;i(a)},placeholder:"0 / 120",maxLength:120,required:!0}),(0,s.jsx)("input",{className:"saychat__btn",type:"submit",value:"게시하기"})]})})},g=e=>{let{size:a="medium",message:t="로딩 중...",fullScreen:n=!1}=e;return(0,s.jsx)("div",{className:(()=>{let e="loading-spinner";return e+=" loading-spinner--".concat(a),n&&(e+=" loading-spinner--fullscreen"),e})(),children:(0,s.jsxs)("div",{className:"loading-spinner__container",children:[(0,s.jsxs)("div",{className:"loading-spinner__circle",children:[(0,s.jsx)("div",{className:"loading-spinner__wave"}),(0,s.jsx)("div",{className:"loading-spinner__wave"}),(0,s.jsx)("div",{className:"loading-spinner__wave"})]}),t&&(0,s.jsx)("p",{className:"loading-spinner__message",children:t})]})})},j=e=>{let{places:a,isMobile:t,handleChangeDetail:i,chatState:d}=e,[m,j]=(0,l.useState)("전체"),[_,v]=(0,l.useState)(!1),[y,f]=(0,l.useState)({}),[b,w]=(0,l.useState)(0),[k,N]=(0,l.useState)(0),[C,S]=(0,l.useState)(!0),[I,D]=(0,l.useState)(null),M=(0,l.useRef)(null),z=(0,l.useRef)(null),A=(0,l.useRef)(null),L=(0,l.useRef)(null),O=e=>function(){i(e)},R=(e,a,t)=>function(){A.current&&A.current.setMap(null),a.setMap(e),f(t),v(!0),A.current=a},E=e=>function(){e.setMap(null),v(!1)},T=(e,a)=>function(){a.setMap(e),v(!0)},P=e=>function(){e.setMap(null),v(!1)},B=(0,l.useCallback)(e=>{let a=document.createElement("div");a.className="place__infowindow",a.innerHTML='\n      <div class="infowindow__content">\n        <h5 class="infowindow__title">'.concat(e.name,'</h5>\n        <span class="infowindow__type">').concat(e.type,"</span>\n      </div>\n    ");let s=new window.kakao.maps.LatLng(parseFloat(e.geocode[0]),parseFloat(e.geocode[1])),n=new window.kakao.maps.CustomOverlay({content:a,position:s,yAnchor:2.5,clickable:!0}),l="",i="맛집"===e.type?"https://cdn.jsdelivr.net/gh/vangona/jeju-guide@main/src/img/restaurant.png":"카페 & 베이커리"===e.type?"https://cdn.jsdelivr.net/gh/vangona/jeju-guide@main/src/img/cafe.png":"숙소"===e.type?"https://cdn.jsdelivr.net/gh/vangona/jeju-guide@main/src/img/hotel.png":"술집"===e.type?"https://cdn.jsdelivr.net/gh/vangona/jeju-guide@main/src/img/drink.png":"풍경"===e.type?"https://cdn.jsdelivr.net/gh/vangona/jeju-guide@main/src/img/landscape.png":"https://cdn.jsdelivr.net/gh/vangona/jeju-guide@main/src/img/basic.png",r=new window.kakao.maps.Size(40,40),o={offset:new window.kakao.maps.Point(20,40)},c=new window.kakao.maps.MarkerImage(i,r,o),d=new window.kakao.maps.Marker({image:c,position:s}),p=()=>{if(d.getImage()){let e=document.createElement("div");e.className="marker-click-feedback",e.style.cssText="\n          position: absolute;\n          width: 60px;\n          height: 60px;\n          border: 2px solid rgba(255, 255, 255, 0.8);\n          border-radius: 50%;\n          animation: markerPulse 0.6s ease-out;\n          pointer-events: none;\n          z-index: 1000;\n        ",document.body.appendChild(e),setTimeout(()=>e.remove(),600)}};return t?(window.kakao.maps.event.addListener(d,"click",()=>{p(),R(z.current,n,e)()}),window.kakao.maps.event.addListener(z.current,"click",E(n))):(window.kakao.maps.event.addListener(d,"click",()=>{p(),O(e)()}),window.kakao.maps.event.addListener(d,"mouseover",T(z.current,n)),window.kakao.maps.event.addListener(d,"mouseout",P(n))),d},[t]),F=(0,l.useCallback)(()=>{var e;if(!M.current){D("지도 컨테이너를 찾을 수 없습니다."),S(!1);return}if(!(null==(e=window.kakao)?void 0:e.maps)){console.log("카카오맵 API 로딩 중...");let e=()=>{var a;(null==(a=window.kakao)?void 0:a.maps)?F():setTimeout(e,100)};e();return}try{let e=t?11:10,a={center:new window.kakao.maps.LatLng(33.3717,126.5602),level:e};z.current=new window.kakao.maps.Map(M.current,a),L.current=new window.kakao.maps.MarkerClusterer({map:z.current,averageCenter:!0,minLevel:9}),S(!1),D(null)}catch(e){D("지도 초기화에 실패했습니다."),S(!1)}},[t]),U=e=>{if(e&&e.length>0&&z.current){let a=e[e.length-1],t=document.createElement("div");t.className="place__infowindow",t.innerHTML="".concat(a.text);let s=new window.kakao.maps.LatLng(a.location[0],a.location[1]),n=new window.kakao.maps.CustomOverlay({content:t,position:s,yAnchor:2.5,clickable:!0});n.setMap(z.current),setTimeout(()=>{n.setMap(null)},3e3)}};return((0,l.useEffect)(()=>{F()},[F]),(0,l.useEffect)(()=>{if(!z.current||!L.current)return;let e=[];L.current.clear(),a.forEach(a=>{if("전체"===m||a.type===m){let t=B(a);e.push(t)}}),e.length>0&&L.current.addMarkers(e)},[m,a,B]),(0,l.useEffect)(()=>{let e=(0,h.aQ)((0,h.rJ)(x.C5,"chats"),e=>{U(e.docs.map(e=>(0,n._)({id:e.id},e.data())))});return()=>e()},[]),I)?(0,s.jsx)("div",{className:"map__container map__container--error",children:(0,s.jsxs)("div",{className:"map__error",children:[(0,s.jsx)(o.g,{icon:c.Pcr,size:"2x"}),(0,s.jsx)("p",{children:I}),(0,s.jsx)("button",{onClick:F,className:"btn-retry",children:"다시 시도"})]})}):(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"map__container",children:(0,s.jsxs)("div",{className:"vertical",children:[(0,s.jsxs)("div",{className:"map__controls",children:[(0,s.jsxs)("div",{className:"map__filter-group",children:[(0,s.jsx)(o.g,{icon:c.mRM,className:"map__filter-icon"}),(0,s.jsxs)("select",{className:"place-type__map",name:"input__place-type",onChange:e=>{let{target:{value:a}}=e;j(a)},value:m,children:[(0,s.jsx)("option",{value:"전체",children:"전체"}),(0,s.jsx)("option",{value:"맛집",children:"맛집"}),(0,s.jsx)("option",{value:"카페 & 베이커리",children:"카페 & 베이커리"}),(0,s.jsx)("option",{value:"풍경",children:"풍경"}),(0,s.jsx)("option",{value:"술집",children:"술집"}),(0,s.jsx)("option",{value:"숙소",children:"숙소"}),(0,s.jsx)("option",{value:"그 외 가볼만한 곳",children:"그 외 가볼만한 곳"})]})]}),(0,s.jsxs)("button",{className:"check-geolocation",onClick:()=>{let e=e=>{let a=new window.kakao.maps.Size(25,25),t={offset:new window.kakao.maps.Point(12.5,25)},s=new window.kakao.maps.MarkerImage("https://cdn.jsdelivr.net/gh/vangona/jeju-guide@main/src/img/tourist.png",a,t),n=new window.kakao.maps.Marker({image:s,position:e});z.current&&n.setMap(z.current)};navigator.geolocation?navigator.geolocation.getCurrentPosition(a=>{let t=a.coords.latitude,s=a.coords.longitude;w(t),N(s),e(new window.kakao.maps.LatLng(t,s))}):alert("위치 정보를 이용할 수 없습니다.")},title:"현재 위치 표시",children:[(0,s.jsx)(o.g,{icon:c.agC}),(0,s.jsx)("span",{className:"btn-text",children:"현재 위치"})]})]}),(0,s.jsxs)("div",{className:"map__wrapper",children:[C&&(0,s.jsx)("div",{className:"map__loading",children:(0,s.jsx)(g,{message:"지도를 불러오고 있습니다..."})}),(0,s.jsx)("div",{className:"map",ref:M})]}),_&&t&&(0,s.jsxs)("div",{className:"marker__detail",children:[(0,s.jsxs)("div",{className:"marker__detail-header",children:[(0,s.jsx)("h4",{children:y.name}),(0,s.jsxs)("div",{className:"marker__detail-actions",children:[(0,s.jsx)(p.A,{place:y,size:"small"}),(0,s.jsx)(r(),{href:"/detail/".concat(y.name),className:"btn-detail",children:(0,s.jsx)(o.g,{icon:c.DY7})})]})]}),(0,s.jsxs)("p",{className:"marker__detail-description",children:[y.description.slice(0,50),y.description.length>50&&"..."]})]}),d&&(0,s.jsx)(u,{latitude:b,longitude:k})]})})})};var _=t(7888),v=t(7109);t(8953),t(2161),t(6667),t(3834);let y=e=>{let{place:a,handleModalContentChange:t}=e,[n,i]=(0,l.useState)(!1),[d,m]=(0,l.useState)(new Set),x=async()=>{try{await navigator.clipboard.writeText(a.addressDetail||a.address||""),i(!0),setTimeout(()=>i(!1),2e3)}catch(t){let e=document.createElement("textarea");e.value=a.addressDetail||a.address||"",document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),i(!0),setTimeout(()=>i(!1),2e3)}},h=e=>{m(a=>new Set(a).add(e))};return(0,l.useEffect)(()=>{m(new Set)},[a.id]),(0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&t(null)};return document.addEventListener("keydown",e),document.body.style.overflow="hidden",()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t]),(0,s.jsx)("div",{onClick:e=>{e.target===e.currentTarget&&t(null)},className:"modal-overlay",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:(0,s.jsxs)("div",{className:"modal-content",children:[(0,s.jsxs)("div",{className:"modal-header",children:[(0,s.jsxs)("div",{className:"modal-title-section",children:[(0,s.jsx)(o.g,{icon:c.Pcr,className:"modal-location-icon"}),(0,s.jsx)("h2",{id:"modal-title",className:"modal-title",children:a.name})]}),(0,s.jsx)("button",{className:"modal-close-btn",onClick:()=>{t(null)},"aria-label":"모달 닫기",children:(0,s.jsx)(o.g,{icon:c.GRI})})]}),(0,s.jsxs)("div",{className:"modal-body",children:[a.attachmentUrlArray&&a.attachmentUrlArray.length>0&&(0,s.jsxs)("div",{className:"modal-image-container",children:[1===a.attachmentUrlArray.length?(0,s.jsxs)("div",{className:"swiper-zoom-container",children:[!d.has(0)&&(0,s.jsx)("div",{className:"image-skeleton",children:(0,s.jsx)("div",{className:"skeleton-shimmer"})}),(0,s.jsx)("img",{className:"modal-image ".concat(d.has(0)?"loaded":"loading"),src:a.attachmentUrlArray[0],alt:"".concat(a.name," 이미지"),loading:"lazy",onLoad:()=>h(0)})]}):(0,s.jsx)(_.RC,{modules:[v.Vx,v.dK,v.GP],spaceBetween:0,slidesPerView:1,navigation:!0,pagination:{clickable:!0,dynamicBullets:!0},zoom:{maxRatio:3,minRatio:1},className:"modal-swiper",children:a.attachmentUrlArray.map((e,t)=>(0,s.jsx)(_.qr,{children:(0,s.jsxs)("div",{className:"swiper-zoom-container",children:[!d.has(t)&&(0,s.jsx)("div",{className:"image-skeleton",children:(0,s.jsx)("div",{className:"skeleton-shimmer"})}),(0,s.jsx)("img",{className:"modal-image ".concat(d.has(t)?"loaded":"loading"),src:e,alt:"".concat(a.name," 이미지 ").concat(t+1),loading:"lazy",onLoad:()=>h(t)})]})},t))}),a.attachmentUrlArray.length>1&&(0,s.jsxs)("div",{className:"image-count",children:[a.attachmentUrlArray.length,"장의 사진"]})]}),a.type&&(0,s.jsx)("span",{className:"modal-place-type",children:a.type}),(0,s.jsx)("div",{className:"modal-description",children:a.description}),a.address&&(0,s.jsxs)("div",{className:"modal-address",children:[(0,s.jsxs)("div",{className:"address-content",children:[(0,s.jsx)(o.g,{icon:c.Pcr,className:"address-icon"}),(0,s.jsx)("span",{className:"address-text",children:a.addressDetail})]}),(0,s.jsx)("button",{className:"copy-btn ".concat(n?"copy-btn--copied":""),onClick:x,"aria-label":"주소 복사",title:n?"복사됨!":"주소 복사",children:(0,s.jsx)(o.g,{icon:n?c.e68:c.jPR})})]})]}),(0,s.jsx)("div",{className:"modal-footer",children:(0,s.jsxs)("div",{className:"modal-actions",children:[(0,s.jsx)(p.A,{place:a,size:"medium",showLabel:!0}),a.url&&(0,s.jsxs)("a",{href:a.url,target:"_blank",rel:"noreferrer",className:"modal-btn modal-btn--secondary",children:[(0,s.jsx)(o.g,{icon:c.AaJ}),(0,s.jsx)("span",{children:"관련 사이트"})]}),(0,s.jsxs)(r(),{href:"/detail/".concat(a.name),className:"modal-btn modal-btn--primary",children:[(0,s.jsx)(o.g,{icon:c.iW_}),(0,s.jsx)("span",{children:"자세히 보기"})]})]})})]})})};var f=t(5046),b=t(5938);let w=async(e,a)=>{let t=await fetch("https://api.openai.com/v1/embeddings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(a)},body:JSON.stringify({model:"text-embedding-ada-002",input:e})});if(!t.ok)throw Error("Failed to create embedding");return(await t.json()).data[0].embedding},k=async function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;try{let t=(0,h.rJ)(x.C5,"places"),s=e.toLowerCase(),n=await (0,h.GG)(t),l=[];n.forEach(e=>{var a,t,n;let i=e.data();i.id=e.id;let r=(null==(a=i.name)?void 0:a.toLowerCase())||"",o=(null==(t=i.description)?void 0:t.toLowerCase())||"",c=(null==(n=i.address)?void 0:n.toLowerCase())||"";(r.includes(s)||o.includes(s)||c.includes(s))&&l.push(i)});let i=l.map(e=>{var a,t;let n=0,l=(null==(a=e.name)?void 0:a.toLowerCase())||"",i=(null==(t=e.description)?void 0:t.toLowerCase())||"";return l.includes(s)&&(n+=10),i.includes(s)&&(n+=5),l===s&&(n+=20),{place:e,score:n}});return console.log(i),i.sort((e,a)=>a.score-e.score).slice(0,a).map(e=>e.place)}catch(e){return[]}},N=async function(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;try{return await w(e,a),k(e,t)}catch(a){return k(e,t)}},C=e=>0===e.length?"검색 결과가 없습니다.":e.map((e,a)=>"".concat(a+1,". ").concat(e.name,"\n주소: ").concat(e.address).concat(e.extraAddress?" ".concat(e.extraAddress):"","\n설명: ").concat(e.description,"\n종류: ").concat(e.type,"\n")).join("\n---\n"),S=e=>{let{place:a,onPlaceClick:t}=e;return(0,s.jsx)("div",{onClick:()=>{t&&t(a)},style:{border:"1px solid #e9ecef",borderRadius:"10px",padding:"12px",marginBottom:"8px",cursor:"pointer",transition:"all 0.2s",backgroundColor:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.05)",fontSize:"13px"},onMouseOver:e=>{e.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.1)",e.currentTarget.style.transform="translateY(-2px)"},onMouseOut:e=>{e.currentTarget.style.boxShadow="0 2px 4px rgba(0,0,0,0.05)",e.currentTarget.style.transform="translateY(0)"},children:(0,s.jsxs)("div",{style:{display:"flex",gap:"12px"},children:[a.attachmentUrlArray&&a.attachmentUrlArray.length>0?(0,s.jsx)("img",{src:a.attachmentUrlArray[0],alt:a.name,style:{width:"60px",height:"60px",borderRadius:"8px",objectFit:"cover"}}):(0,s.jsx)("div",{style:{width:"60px",height:"60px",borderRadius:"8px",backgroundColor:"#f8f9fa",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"20px"},children:"restaurant"===a.type?"\uD83C\uDF7D️":"cafe"===a.type?"☕":"hotel"===a.type?"\uD83C\uDFE8":"tourist"===a.type?"\uD83C\uDFDB️":"landscape"===a.type?"\uD83C\uDFDE️":"\uD83D\uDCCD"}),(0,s.jsxs)("div",{style:{flex:1},children:[(0,s.jsx)("h4",{style:{margin:"0 0 6px 0",fontSize:"14px",fontWeight:"600",color:"#333"},children:a.name}),(0,s.jsxs)("p",{style:{margin:"0 0 4px 0",fontSize:"13px",color:"#6c757d",display:"flex",alignItems:"center",gap:"4px"},children:[(0,s.jsx)("span",{children:"\uD83D\uDCCD"})," ",a.address]}),(0,s.jsx)("p",{style:{margin:"0",fontSize:"13px",color:"#495057",lineHeight:"1.4",overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:a.description}),(0,s.jsxs)("div",{style:{marginTop:"8px",display:"flex",alignItems:"center",gap:"8px"},children:[(0,s.jsx)("span",{style:{fontSize:"11px",padding:"3px 8px",backgroundColor:"#667eea",color:"white",borderRadius:"12px"},children:"restaurant"===a.type?"맛집":"cafe"===a.type?"카페":"hotel"===a.type?"숙소":"tourist"===a.type?"관광지":"landscape"===a.type?"자연경관":"기타"}),a.url&&(0,s.jsx)("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),style:{fontSize:"11px",color:"#667eea",textDecoration:"none"},children:"\uD83D\uDD17 웹사이트"})]})]})]})})};var I=t(6956),D=t.n(I);let M=e=>{let{isOpen:a,onClose:t}=e,[n,i]=(0,l.useState)(""),[r,o]=(0,l.useState)([{role:"assistant",content:"안녕하세요! 제주도 여행에 대해 궁금한 것이 있으시면 물어보세요!"}]),[c,d]=(0,l.useState)(!1),[p,m]=(0,l.useState)(localStorage.getItem("openai_api_key")||""),[x,h]=(0,l.useState)(!p),u=(0,l.useRef)(null),g=()=>{var e;null==(e=u.current)||e.scrollIntoView({behavior:"smooth"})};(0,l.useEffect)(()=>{g()},[r,c]);let j=e=>[/^#{1,6}\s/m,/\*\*.*\*\*/,/\*.*\*/,/\[.*\]\(.*\)/,/^-\s/m,/^\d+\.\s/m,/```/,/`.*`/].some(a=>a.test(e));b.xI.setOptions({breaks:!0,gfm:!0});let _=(e,a)=>{if("assistant"===a&&j(e)){let a=b.xI.parse(e);return(0,s.jsx)("div",{className:D().markdownContent,dangerouslySetInnerHTML:{__html:a},style:{lineHeight:"1.6",wordBreak:"break-word"}})}return(0,s.jsx)("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontFamily:"inherit",margin:0,lineHeight:"1.6"},children:e})},v=async e=>{if(e.preventDefault(),!n.trim()||c||!p)return;let a={role:"user",content:n};o(e=>[...e,a]),i(""),d(!0);try{let e=await N(n,p,5),a=C(e),t=await fetch("/api/ai-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n,apiKey:p,relatedPlaces:a})}),s=await t.json(),l={role:"assistant",content:s.message,places:e.length>0?e:void 0};o(e=>[...e,l])}catch(a){let e={role:"assistant",content:"죄송합니다. 오류가 발생했습니다."};o(a=>[...a,e])}finally{d(!1)}};return a?(0,s.jsx)("div",{className:D().aiChatModal,style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.6)",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",padding:"20px"},children:(0,s.jsxs)("div",{className:D().aiChatContainer,style:{background:"white",borderRadius:"20px",width:"100%",maxWidth:"450px",maxHeight:"600px",display:"flex",flexDirection:"column",boxShadow:"0 20px 40px rgba(0,0,0,0.1)",overflow:"hidden"},children:[(0,s.jsxs)("div",{style:{padding:"20px",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,s.jsx)("span",{style:{fontSize:"24px"},children:"\uD83C\uDFDD️"}),(0,s.jsx)("h3",{style:{margin:0,fontSize:"18px",fontWeight:"600"},children:"제주 AI 가이드"})]}),(0,s.jsxs)("div",{style:{display:"flex",gap:"8px"},children:[(0,s.jsx)("button",{onClick:()=>h(!x),style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",color:"white",padding:"8px",cursor:"pointer",fontSize:"16px",transition:"all 0.2s"},onMouseOver:e=>e.target.style.background="rgba(255,255,255,0.3)",onMouseOut:e=>e.target.style.background="rgba(255,255,255,0.2)",children:"⚙️"}),(0,s.jsx)("button",{onClick:t,style:{background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"8px",color:"white",padding:"8px 12px",cursor:"pointer",fontSize:"16px",transition:"all 0.2s"},onMouseOver:e=>e.target.style.background="rgba(255,255,255,0.3)",onMouseOut:e=>e.target.style.background="rgba(255,255,255,0.2)",children:"✕"})]})]}),x&&(0,s.jsxs)("div",{style:{margin:"20px",padding:"20px",backgroundColor:"#f8f9fa",borderRadius:"12px",border:"1px solid #e9ecef"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px",marginBottom:"12px"},children:[(0,s.jsx)("span",{style:{fontSize:"16px"},children:"\uD83D\uDD11"}),(0,s.jsx)("p",{style:{margin:0,fontSize:"14px",fontWeight:"500",color:"#495057"},children:"OpenAI API 키를 입력하세요"})]}),(0,s.jsx)("input",{type:"password",value:p,onChange:e=>m(e.target.value),placeholder:"sk-...",style:{width:"100%",padding:"12px",marginBottom:"12px",border:"2px solid #e9ecef",borderRadius:"8px",fontSize:"14px",outline:"none",transition:"border-color 0.2s",boxSizing:"border-box"},onFocus:e=>e.target.style.borderColor="#667eea",onBlur:e=>e.target.style.borderColor="#e9ecef"}),(0,s.jsx)("button",{onClick:()=>{p.trim()&&(localStorage.setItem("openai_api_key",p),h(!1))},style:{width:"100%",padding:"12px",backgroundColor:"#28a745",color:"white",border:"none",borderRadius:"8px",fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.2s"},onMouseOver:e=>e.target.style.backgroundColor="#218838",onMouseOut:e=>e.target.style.backgroundColor="#28a745",children:"\uD83D\uDCBE 저장"})]}),(0,s.jsxs)("div",{className:D().aiChatMessages,style:{flex:1,padding:"20px",overflowY:"auto",maxHeight:"400px"},children:[r.map((e,a)=>(0,s.jsx)("div",{style:{marginBottom:"16px",display:"flex",justifyContent:"user"===e.role?"flex-end":"flex-start"},children:(0,s.jsxs)("div",{style:{maxWidth:"80%",padding:"12px 16px",borderRadius:"user"===e.role?"20px 20px 4px 20px":"20px 20px 20px 4px",backgroundColor:"user"===e.role?"#667eea":"#f8f9fa",color:"user"===e.role?"white":"#333",fontSize:"14px",lineHeight:"1.4",wordBreak:"break-word"},children:["assistant"===e.role&&(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"6px",marginBottom:"4px"},children:[(0,s.jsx)("span",{style:{fontSize:"16px"},children:"\uD83E\uDD16"}),(0,s.jsx)("span",{style:{fontSize:"12px",fontWeight:"500",color:"#6c757d"},children:"AI 가이드"})]}),_(e.content,e.role),e.places&&e.places.length>0&&(0,s.jsxs)("div",{style:{marginTop:"12px"},children:[(0,s.jsxs)("div",{style:{fontSize:"12px",fontWeight:"500",color:"#6c757d",marginBottom:"8px"},children:["\uD83D\uDCCD 추천 장소 (",e.places.length,"곳)"]}),e.places.map((e,a)=>(0,s.jsx)(S,{place:e,onPlaceClick:e=>{e.url&&window.open(e.url,"_blank")}},e.id||a))]})]})},a)),c&&(0,s.jsx)("div",{style:{display:"flex",justifyContent:"flex-start",marginBottom:"16px"},children:(0,s.jsx)("div",{style:{padding:"12px 16px",borderRadius:"20px 20px 20px 4px",backgroundColor:"#f8f9fa",color:"#6c757d",fontSize:"14px"},children:(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[(0,s.jsx)("span",{children:"\uD83E\uDD16"}),(0,s.jsx)("span",{children:"생각 중..."}),(0,s.jsxs)("div",{style:{display:"flex",gap:"2px"},children:[(0,s.jsx)("div",{style:{width:"4px",height:"4px",backgroundColor:"#6c757d",borderRadius:"50%",animation:"pulse 1.5s infinite"}}),(0,s.jsx)("div",{style:{width:"4px",height:"4px",backgroundColor:"#6c757d",borderRadius:"50%",animation:"pulse 1.5s infinite 0.5s"}}),(0,s.jsx)("div",{style:{width:"4px",height:"4px",backgroundColor:"#6c757d",borderRadius:"50%",animation:"pulse 1.5s infinite 1s"}})]})]})})}),(0,s.jsx)("div",{ref:u})]}),(0,s.jsxs)("div",{style:{padding:"20px",borderTop:"1px solid #e9ecef",backgroundColor:"#fff"},children:[(0,s.jsxs)("form",{onSubmit:v,style:{display:"flex",gap:"12px",alignItems:"flex-end"},children:[(0,s.jsx)("div",{style:{flex:1},children:(0,s.jsx)("input",{type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"제주도에 대해 물어보세요... (예: 맛집 추천해주세요)",style:{width:"100%",padding:"14px 16px",border:"2px solid #e9ecef",borderRadius:"12px",fontSize:"14px",outline:"none",transition:"border-color 0.2s",boxSizing:"border-box",resize:"none"},disabled:c,onFocus:e=>e.target.style.borderColor="#667eea",onBlur:e=>e.target.style.borderColor="#e9ecef"})}),(0,s.jsxs)("button",{type:"submit",disabled:c||!n.trim()||!p,style:{padding:"14px 20px",backgroundColor:c||!p?"#ccc":"#667eea",color:"white",border:"none",borderRadius:"12px",fontSize:"14px",fontWeight:"500",cursor:c||!p?"not-allowed":"pointer",transition:"all 0.2s",minWidth:"80px",display:"flex",alignItems:"center",justifyContent:"center",gap:"6px"},onMouseOver:e=>{!c&&p&&n.trim()&&(e.target.style.backgroundColor="#5a67d8")},onMouseOut:e=>{!c&&p&&(e.target.style.backgroundColor="#667eea")},children:[p?c?"⏳":"\uD83D\uDE80":"\uD83D\uDD11",(0,s.jsx)("span",{children:p?c?"전송중":"전송":"API키"})]})]}),!p&&(0,s.jsxs)("div",{style:{marginTop:"12px",padding:"8px 12px",backgroundColor:"#fff3cd",border:"1px solid #ffeaa7",borderRadius:"8px",fontSize:"12px",color:"#856404",display:"flex",alignItems:"center",gap:"6px"},children:[(0,s.jsx)("span",{children:"⚠️"}),(0,s.jsx)("span",{children:"채팅을 시작하려면 위의 ⚙️ 버튼을 클릭하여 OpenAI API 키를 입력하세요."})]})]})]})}):null},z=e=>{let{userObj:a}=e;return(0,s.jsxs)("div",{className:"profile__container",children:[(0,s.jsx)("div",{children:(0,s.jsx)("h1",{children:"프로필 화면"})}),(0,s.jsx)("div",{children:null==a?void 0:a.uid})]})},A=e=>{let{isMobile:a,userObj:t}=e,[i,r]=(0,l.useState)(null),[o,c]=(0,l.useState)(!1),[d,p]=(0,l.useState)([]),[u,_]=(0,l.useState)("지도"),[v,b]=(0,l.useState)(!1),w=async()=>{(0,h.aQ)((0,h.rJ)(x.C5,"places"),e=>{p(e.docs.map(e=>(0,n._)({},e.data()))),c(!0)})},k=e=>{r(e)};return(0,l.useEffect)(()=>{w()},[]),(0,s.jsxs)("div",{className:"home__container",children:[(0,s.jsxs)("div",{className:"vertical",children:[(0,s.jsx)("h3",{className:"home__title",children:"MICHETAIN GUIDE"}),!0===o&&"지도"===u?(0,s.jsx)(j,{places:d,isMobile:a,handleChangeDetail:k,chatState:!1}):!0===o&&"목록"===u?(0,s.jsx)(m,{places:d,isMobile:a}):!0===o&&"프로필"===u?(0,s.jsx)(z,{userObj:t}):(0,s.jsx)(g,{message:"장소 정보를 불러오고 있습니다..."})]}),i&&(0,s.jsx)(y,{place:i,handleModalContentChange:k}),(0,s.jsx)(M,{isOpen:v,onClose:()=>b(!1)}),(0,s.jsx)("button",{onClick:()=>b(!0),style:{position:"fixed",bottom:"80px",right:"20px",width:"60px",height:"60px",borderRadius:"50%",backgroundColor:"#007bff",color:"white",border:"none",fontSize:"24px",cursor:"pointer",zIndex:999},children:"\uD83E\uDD16"}),(0,s.jsx)(f.A,{handleViewTypeChange:e=>{_(e)}})]})};function L(e){let{userObj:a,isMobile:t}=e;return(0,s.jsx)(A,{userObj:a,isMobile:t})}}},e=>{var a=a=>e(e.s=a);e.O(0,[725,772,650,230,423,636,593,792],()=>a(6760)),_N_E=e.O()}]);