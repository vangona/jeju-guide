(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[252],{3244:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/edit",function(){return a(8578)}])},8578:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>p});var l=a(3576),n=a(2701),t=a(7876),c=a(4232),i=a(9099),r=a(1772),d=a(1041),o=a(5665),h=a(8312);let p=()=>{let e=(0,i.useRouter)(),[s,a]=(0,c.useState)([]),[p,m]=(0,c.useState)([]),[x,_]=(0,c.useState)(!0),[u,j]=(0,c.useState)(null),[v,N]=(0,c.useState)(""),[g,y]=(0,c.useState)("전체"),[b,f]=(0,c.useState)(""),[C,w]=(0,c.useState)(!1),[k,U]=(0,c.useState)({name:"",type:"",description:"",address:"",url:"",attachmentUrlArray:[""]}),A=async()=>{try{if(_(!0),!h.y1.currentUser)return void e.push("/auth");let s=(0,o.P)((0,o.rJ)(h.C5,"places")),n=await (0,o.GG)(s),t=[];n.forEach(e=>{let s=e.data();t.push((0,l._)({id:e.id},s))}),a(t)}catch(e){f("장소 정보를 불러오는데 실패했습니다.")}finally{_(!1)}};(0,c.useEffect)(()=>{A()},[]),(0,c.useEffect)(()=>{let e=s;v&&(e=e.filter(e=>e.name.toLowerCase().includes(v.toLowerCase())||e.description.toLowerCase().includes(v.toLowerCase())||e.address.toLowerCase().includes(v.toLowerCase()))),"전체"!==g&&(e=e.filter(e=>e.type===g)),m(e)},[s,v,g]);let S=e=>{j(e),U({name:e.name,type:e.type,description:e.description,address:e.address||"",url:e.url||"",attachmentUrlArray:e.attachmentUrlArray||[""]})},L=(e,s)=>{U(a=>(0,n._)((0,l._)({},a),{[e]:s}))},E=(e,s)=>{U(a=>(0,n._)((0,l._)({},a),{attachmentUrlArray:a.attachmentUrlArray.map((a,l)=>l===e?s:a)}))},G=e=>{k.attachmentUrlArray.length>1&&U(s=>(0,n._)((0,l._)({},s),{attachmentUrlArray:s.attachmentUrlArray.filter((s,a)=>a!==e)}))},R=async()=>{if(u)try{w(!0);let e=(0,n._)((0,l._)({},k),{attachmentUrlArray:k.attachmentUrlArray.filter(e=>""!==e.trim()),updatedAt:Date.now()});await (0,o.mZ)((0,o.H9)(h.C5,"places",u.id),e),a(s=>s.map(s=>s.id===u.id?(0,l._)({},s,e):s)),j(null),f("")}catch(e){f("정보 업데이트에 실패했습니다.")}finally{w(!1)}},P=async e=>{if(window.confirm('"'.concat(e.name,'"을(를) 삭제하시겠습니까?\n\n이 작업은 되돌릴 수 없습니다.')))try{await (0,o.kd)((0,o.H9)(h.C5,"places",e.id)),a(s=>s.filter(s=>s.id!==e.id))}catch(e){f("장소 삭제에 실패했습니다.")}};return x?(0,t.jsx)("div",{className:"edit__page",children:(0,t.jsxs)("div",{className:"edit__loading",children:[(0,t.jsx)(r.g,{icon:d.z1G,spin:!0,size:"2x"}),(0,t.jsx)("p",{children:"장소 정보를 불러오고 있습니다..."})]})}):(0,t.jsxs)("div",{className:"edit__page",children:[(0,t.jsx)("header",{className:"edit__header",children:(0,t.jsxs)("div",{className:"edit__nav",children:[(0,t.jsxs)("button",{className:"nav-btn nav-btn--back",onClick:()=>{e.back()},children:[(0,t.jsx)(r.g,{icon:d.CeG}),(0,t.jsx)("span",{children:"뒤로"})]}),(0,t.jsx)("h1",{className:"edit__title",children:"장소 관리"}),(0,t.jsxs)("button",{className:"nav-btn nav-btn--home",onClick:()=>{e.push("/")},children:[(0,t.jsx)(r.g,{icon:d.v02}),(0,t.jsx)("span",{children:"홈"})]})]})}),(0,t.jsxs)("div",{className:"edit__content",children:[b&&(0,t.jsxs)("div",{className:"edit__error",children:[(0,t.jsx)("span",{children:b}),(0,t.jsx)("button",{onClick:()=>f(""),children:(0,t.jsx)(r.g,{icon:d.GRI})})]}),(0,t.jsxs)("div",{className:"edit__controls",children:[(0,t.jsxs)("div",{className:"search__container",children:[(0,t.jsx)(r.g,{icon:d.MjD,className:"search__icon"}),(0,t.jsx)("input",{type:"text",placeholder:"장소 이름, 설명, 주소로 검색...",value:v,onChange:e=>N(e.target.value),className:"search__input"})]}),(0,t.jsxs)("div",{className:"filter__container",children:[(0,t.jsx)(r.g,{icon:d.mRM,className:"filter__icon"}),(0,t.jsxs)("select",{value:g,onChange:e=>y(e.target.value),className:"filter__select",children:[(0,t.jsx)("option",{value:"전체",children:"전체 타입"}),(()=>{let e=s.map(e=>e.type),a=[];return e.forEach(e=>{a.includes(e)||a.push(e)}),a})().map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),(0,t.jsx)("div",{className:"edit__places",children:0===p.length?(0,t.jsxs)("div",{className:"edit__empty",children:[(0,t.jsx)(r.g,{icon:d.Pcr,className:"empty__icon"}),(0,t.jsx)("h3",{children:"등록된 장소가 없습니다"}),(0,t.jsx)("p",{children:"새로운 장소를 등록해보세요!"}),(0,t.jsx)("button",{className:"btn-primary",onClick:()=>e.push("/post"),children:"장소 등록하기"})]}):p.map(e=>(0,t.jsxs)("div",{className:"place__card",children:[(0,t.jsxs)("div",{className:"place__info",children:[(0,t.jsxs)("div",{className:"place__header",children:[(0,t.jsx)("h3",{className:"place__name",children:e.name}),(0,t.jsx)("span",{className:"place__type",children:e.type})]}),(0,t.jsx)("p",{className:"place__description",children:e.description.length>100?"".concat(e.description.slice(0,100),"..."):e.description}),e.address&&(0,t.jsxs)("div",{className:"place__address",children:[(0,t.jsx)(r.g,{icon:d.Pcr}),(0,t.jsx)("span",{children:e.address})]})]}),(0,t.jsxs)("div",{className:"place__actions",children:[(0,t.jsxs)("button",{className:"btn-edit",onClick:()=>S(e),children:[(0,t.jsx)(r.g,{icon:d.MT7}),(0,t.jsx)("span",{children:"수정"})]}),(0,t.jsxs)("button",{className:"btn-delete",onClick:()=>P(e),children:[(0,t.jsx)(r.g,{icon:d.yLS}),(0,t.jsx)("span",{children:"삭제"})]})]})]},e.id))})]}),u&&(0,t.jsx)("div",{className:"edit__modal-overlay",children:(0,t.jsxs)("div",{className:"edit__modal",children:[(0,t.jsxs)("div",{className:"modal__header",children:[(0,t.jsx)("h2",{children:"장소 정보 수정"}),(0,t.jsx)("button",{className:"modal__close",onClick:()=>j(null),children:(0,t.jsx)(r.g,{icon:d.GRI})})]}),(0,t.jsxs)("div",{className:"modal__content",children:[(0,t.jsxs)("div",{className:"form__group",children:[(0,t.jsx)("label",{children:"장소명"}),(0,t.jsx)("input",{type:"text",value:k.name,onChange:e=>L("name",e.target.value),placeholder:"장소명을 입력하세요"})]}),(0,t.jsxs)("div",{className:"form__group",children:[(0,t.jsx)("label",{children:"카테고리"}),(0,t.jsxs)("select",{value:k.type,onChange:e=>L("type",e.target.value),children:[(0,t.jsx)("option",{value:"맛집",children:"맛집"}),(0,t.jsx)("option",{value:"카페 & 베이커리",children:"카페 & 베이커리"}),(0,t.jsx)("option",{value:"풍경",children:"풍경"}),(0,t.jsx)("option",{value:"술집",children:"술집"}),(0,t.jsx)("option",{value:"숙소",children:"숙소"}),(0,t.jsx)("option",{value:"그 외 가볼만한 곳",children:"그 외 가볼만한 곳"})]})]}),(0,t.jsxs)("div",{className:"form__group",children:[(0,t.jsx)("label",{children:"설명"}),(0,t.jsx)("textarea",{value:k.description,onChange:e=>L("description",e.target.value),placeholder:"장소에 대한 설명을 입력하세요",rows:4})]}),(0,t.jsxs)("div",{className:"form__group",children:[(0,t.jsx)("label",{children:"주소"}),(0,t.jsx)("input",{type:"text",value:k.address,onChange:e=>L("address",e.target.value),placeholder:"주소를 입력하세요"})]}),(0,t.jsxs)("div",{className:"form__group",children:[(0,t.jsx)("label",{children:"관련 링크"}),(0,t.jsx)("input",{type:"url",value:k.url,onChange:e=>L("url",e.target.value),placeholder:"관련 웹사이트 URL을 입력하세요"})]}),(0,t.jsxs)("div",{className:"form__group",children:[(0,t.jsx)("label",{children:"이미지 URL"}),k.attachmentUrlArray.map((e,s)=>(0,t.jsxs)("div",{className:"image__input-group",children:[(0,t.jsx)("input",{type:"url",value:e,onChange:e=>E(s,e.target.value),placeholder:"이미지 URL을 입력하세요"}),k.attachmentUrlArray.length>1&&(0,t.jsx)("button",{type:"button",onClick:()=>G(s),className:"btn-remove-image",children:(0,t.jsx)(r.g,{icon:d.GRI})})]},s)),(0,t.jsxs)("button",{type:"button",onClick:()=>{U(e=>(0,n._)((0,l._)({},e),{attachmentUrlArray:[...e.attachmentUrlArray,""]}))},className:"btn-add-image",children:[(0,t.jsx)(r.g,{icon:d.Cyq}),(0,t.jsx)("span",{children:"이미지 추가"})]})]})]}),(0,t.jsxs)("div",{className:"modal__footer",children:[(0,t.jsx)("button",{className:"btn-cancel",onClick:()=>j(null),children:"취소"}),(0,t.jsx)("button",{className:"btn-save",onClick:R,disabled:C,children:C?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.g,{icon:d.z1G,spin:!0}),(0,t.jsx)("span",{children:"저장 중..."})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(r.g,{icon:d.hSh}),(0,t.jsx)("span",{children:"저장"})]})})]})]})})]})}},9099:(e,s,a)=>{e.exports=a(8253)}},e=>{var s=s=>e(e.s=s);e.O(0,[725,772,636,593,792],()=>s(3244)),_N_E=e.O()}]);