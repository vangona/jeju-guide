(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[574],{2180:(e,s,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/post",function(){return a(7202)}])},7202:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>g});var i=a(7876),l=a(4232),c=a(9099),t=a(1772),n=a(1041),r=a(3587),d=a(6611),o=a(1423),h=a(8312),m=a(5665),x=a(5226),p=a(7888),j=a(7109);let u=e=>{let{userObj:s}=e,[a,c]=(0,l.useState)(""),[u,g]=(0,l.useState)(""),[N,v]=(0,l.useState)([]),[_,f]=(0,l.useState)("카페 & 베이커리"),[b,w]=(0,l.useState)(""),[y,S]=(0,l.useState)([]),[k,C]=(0,l.useState)(""),[P,R]=(0,l.useState)(""),[O,F]=(0,l.useState)(""),[I,G]=(0,l.useState)(!1),[E,V]=(0,l.useState)(!1),[A,T]=(0,l.useState)(0),[q,B]=(0,l.useState)(!1),[D,L]=(0,l.useState)({}),J=new kakao.maps.services.Geocoder,K=()=>{let e={};return a.trim()||(e.name="장소 이름을 입력해주세요"),O||(e.address="주소를 선택해주세요"),b.trim()||(e.description="장소 설명을 입력해주세요"),b.length<10&&(e.description="설명을 10자 이상 입력해주세요"),L(e),0===Object.keys(e).length},M=async e=>{if(e.preventDefault(),K()){V(!0),T(0);try{let e=[];if(y.length>0)for(let i=0;i<y.length;i++){let l=(0,x.KR)(h.PL,"".concat(null==s?void 0:s.uid,"/").concat(a,"/").concat((0,o.A)())),c=await (0,x.ls)(l,y[i],"data_url"),t=await (0,x.qk)(c.ref);e.push(t),T((i+1)/y.length*100)}let i={name:a,addressDetail:O,address:P,extraAddress:u,geocode:N,type:_,description:b,attachmentUrlArray:e,url:k,creatorId:null==s?void 0:s.uid,createdAt:Date.now()};await (0,m.gS)((0,m.rJ)(h.C5,"places"),i),B(!0),setTimeout(()=>{c(""),R(""),F(""),g(""),v([]),f("카페 & 베이커리"),w(""),S([]),C(""),B(!1),T(0)},2e3)}catch(e){alert("등록 중 오류가 발생했습니다. 다시 시도해주세요.")}finally{V(!1)}}},X=async e=>{let{files:s}=e.target;if(!s)return;if(s.length>=6)return void alert("사진은 5장까지입니다.");let a={maxSizeMB:1,maxWidthOrHeight:1024};try{let e=[];for(let i=0;i<s.length;i++){let l=await (0,r.A)(s[i],a),c=new FileReader;c.readAsDataURL(l),c.onloadend=s=>{let a=s.currentTarget.result;a&&(null==e||e.push(a))}}S(e)}catch(e){}},z=(e,s)=>{s===kakao.maps.services.Status.OK&&v([e[0].y,e[0].x])},U=async e=>{let s=e.address,a="";"R"===e.addressType&&(""!==e.bname&&(a+=e.bname),""!==e.buildingName&&(a+=""!==a?", ".concat(e.buildingName):e.buildingName),s+=""!==a?" (".concat(a,")"):""),await J.addressSearch(s,z),R(e.zonecode),F(s),G(!1)};(0,l.useEffect)(()=>{},[y]);let Q=e=>{S(s=>s.filter((s,a)=>a!==e))};return(0,i.jsxs)("form",{className:"post-form__container",onSubmit:M,children:[q&&(0,i.jsxs)("div",{className:"success-message",children:[(0,i.jsx)(t.g,{icon:n.SGM}),(0,i.jsx)("span",{children:"장소가 성공적으로 등록되었습니다!"})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)(t.g,{icon:n.Pcr}),(0,i.jsx)("h3",{children:"기본 정보"})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"place-name",children:"장소 이름 *"}),(0,i.jsx)("input",{type:"text",name:"place-name",onChange:e=>{let{value:s}=e.target;c(s)},value:a,placeholder:"장소 이름을 입력해주세요",className:D.name?"error":""}),D.name&&(0,i.jsx)("span",{className:"error-text",children:D.name})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"place-type",children:"카테고리 *"}),(0,i.jsxs)("select",{name:"place-type",value:_,onChange:e=>{let{value:s}=e.target;f(s)},children:[(0,i.jsx)("option",{value:"맛집",children:"맛집"}),(0,i.jsx)("option",{value:"카페 & 베이커리",children:"카페 & 베이커리"}),(0,i.jsx)("option",{value:"풍경",children:"풍경"}),(0,i.jsx)("option",{value:"술집",children:"술집"}),(0,i.jsx)("option",{value:"숙소",children:"숙소"}),(0,i.jsx)("option",{value:"그 외 가볼만한 곳",children:"그 외 가볼만한 곳"})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)(t.g,{icon:n.Pcr}),(0,i.jsx)("h3",{children:"위치 정보"})]}),(0,i.jsxs)("div",{className:"address-input",children:[I&&(0,i.jsx)("div",{className:"postcode-container",children:(0,i.jsx)(d.Ay,{autoClose:!0,onComplete:U})}),(0,i.jsxs)("button",{type:"button",onClick:()=>{G(!I)},className:"address-search-btn",children:[(0,i.jsx)(t.g,{icon:n.Pcr}),"주소 검색하기"]})]}),O&&(0,i.jsxs)("div",{className:"address-display",children:[(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{children:"선택된 주소"}),(0,i.jsx)("input",{type:"text",value:O,readOnly:!0,className:"readonly-input"})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"place-extra-address",children:"상세 주소 (선택사항)"}),(0,i.jsx)("input",{type:"text",name:"place-extra-address",onChange:e=>{let{value:s}=e.target;g(s)},value:u,placeholder:"상세 주소를 입력해주세요 (예: 2층, 101호)"})]})]}),D.address&&(0,i.jsx)("span",{className:"error-text",children:D.address}),(0,i.jsx)("input",{className:"place-geocode",type:"hidden",name:"place-geocode",value:N})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)(t.g,{icon:n.Pcr}),(0,i.jsx)("h3",{children:"상세 설명"})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"place-description",children:"장소 설명 *"}),(0,i.jsx)("textarea",{className:"place-description ".concat(D.description?"error":""),name:"place-description",placeholder:"이 장소만의 특별한 점, 추천 이유, 방문 팁 등을 자세히 설명해주세요. (최소 10자 이상)",onChange:e=>{let{value:s}=e.target;w(s)},value:b,rows:5}),(0,i.jsx)("div",{className:"char-count",children:(0,i.jsxs)("span",{className:b.length<10?"insufficient":"",children:[b.length,"/10 (최소)"]})}),D.description&&(0,i.jsx)("span",{className:"error-text",children:D.description})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)(t.g,{icon:n.rwq}),(0,i.jsx)("h3",{children:"사진 업로드"})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"place-img",children:"장소 사진 (최대 5장)"}),(0,i.jsxs)("div",{className:"file-upload-area",children:[(0,i.jsx)("input",{type:"file",accept:"image/*",name:"place-img",onChange:X,multiple:!0,id:"place-img"}),(0,i.jsxs)("label",{htmlFor:"place-img",className:"file-upload-label",children:[(0,i.jsx)(t.g,{icon:n.rOd}),(0,i.jsx)("span",{children:"클릭하여 사진 선택"}),(0,i.jsx)("small",{children:"JPG, PNG 파일만 가능 (최대 5장)"})]})]}),y.length>0&&(0,i.jsxs)("div",{className:"image-preview-section",children:[(0,i.jsxs)("h4",{children:[(0,i.jsx)(t.g,{icon:n.Cyq}),"미리보기 (",y.length,"/5)"]}),(0,i.jsx)(p.RC,{modules:[j.Vx,j.dK],spaceBetween:15,slidesPerView:1,navigation:!0,pagination:{clickable:!0},breakpoints:{480:{slidesPerView:2},768:{slidesPerView:3}},className:"image-preview-swiper",children:y.map((e,s)=>(0,i.jsx)(p.qr,{children:(0,i.jsxs)("div",{className:"image-preview-item",children:[(0,i.jsx)("img",{src:e,alt:"preview ".concat(s+1)}),(0,i.jsx)("button",{type:"button",className:"remove-image-btn",onClick:()=>Q(s),children:(0,i.jsx)(t.g,{icon:n.GRI})})]})},s))})]})]})]}),(0,i.jsxs)("div",{className:"form-section",children:[(0,i.jsxs)("div",{className:"section-header",children:[(0,i.jsx)(t.g,{icon:n.CQO}),(0,i.jsx)("h3",{children:"추가 정보"})]}),(0,i.jsxs)("div",{className:"form-field",children:[(0,i.jsx)("label",{htmlFor:"place-url",children:"관련 웹사이트 (선택사항)"}),(0,i.jsx)("input",{type:"url",name:"place-url",placeholder:"https://example.com",onChange:e=>{let{value:s}=e.target;C(s)},value:k})]})]}),(0,i.jsxs)("div",{className:"submit-section",children:[E&&y.length>0&&(0,i.jsxs)("div",{className:"upload-progress",children:[(0,i.jsx)("div",{className:"progress-bar",children:(0,i.jsx)("div",{className:"progress-fill",style:{width:"".concat(A,"%")}})}),(0,i.jsxs)("span",{children:["이미지 업로드 중... ",Math.round(A),"%"]})]}),(0,i.jsx)("button",{type:"submit",className:"submit-btn",disabled:E,children:E?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.g,{icon:n.z1G,spin:!0}),"등록 중..."]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.g,{icon:n.SGM}),"장소 등록하기"]})})]})]})};a(8953),a(2161),a(6667);let g=e=>{let{userObj:s}=e,a=(0,c.useRouter)(),[r,d]=(0,l.useState)(!1),[o,m]=(0,l.useState)(!0),[x,g]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{s||a.push("/auth")},[s,a]),(0,l.useEffect)(()=>{let e="true"===localStorage.getItem("hidePostIntro"),s="true"===localStorage.getItem("hidePostTips");m(!e),g(!s)},[]),!s)return null;let N=[{icon:n.rwq,title:"사진 팁",description:"자연광이 좋은 시간대에 촬영하면 더 아름다운 사진을 얻을 수 있어요"},{icon:n.BtD,title:"위치 정보",description:"정확한 주소를 입력하면 다른 여행자들이 쉽게 찾을 수 있어요"},{icon:n.rC2,title:"꿀팁 공유",description:"운영시간, 주차정보, 특별한 메뉴 등 실용적인 정보를 포함해보세요"}];return(0,i.jsxs)("div",{className:"post__page",children:[(0,i.jsxs)("div",{className:"post__background",children:[(0,i.jsx)("div",{className:"post__wave"}),(0,i.jsx)("div",{className:"post__wave"}),(0,i.jsx)("div",{className:"post__wave"})]}),(0,i.jsx)("header",{className:"post__header",children:(0,i.jsxs)("div",{className:"post__nav",children:[(0,i.jsxs)("button",{className:"nav-btn nav-btn--back",onClick:()=>{a.back()},children:[(0,i.jsx)(t.g,{icon:n.CeG}),(0,i.jsx)("span",{children:"뒤로"})]}),(0,i.jsxs)("div",{className:"post__title-section",children:[(0,i.jsx)(t.g,{icon:n.Pcr,className:"title-icon"}),(0,i.jsx)("h1",{className:"post__title",children:"새 장소 등록"})]}),(0,i.jsxs)("div",{className:"post__user-section",children:[(0,i.jsxs)("button",{className:"user-profile-btn",onClick:()=>{d(!r)},children:[(0,i.jsx)(t.g,{icon:n.X46}),(0,i.jsx)("span",{className:"user-name",children:s.displayName||"사용자"})]}),r&&(0,i.jsxs)("div",{className:"profile__dropdown",children:[(0,i.jsxs)("div",{className:"profile__info",children:[(0,i.jsx)("div",{className:"profile__avatar",children:s.photoURL?(0,i.jsx)("img",{src:s.photoURL,alt:"프로필"}):(0,i.jsx)(t.g,{icon:n.X46})}),(0,i.jsxs)("div",{className:"profile__details",children:[(0,i.jsx)("p",{className:"profile__name",children:s.displayName||"익명 사용자"}),(0,i.jsx)("p",{className:"profile__email",children:s.uid})]})]}),(0,i.jsxs)("div",{className:"profile__actions",children:[(0,i.jsxs)("button",{className:"profile__action",onClick:()=>{a.push("/")},children:[(0,i.jsx)(t.g,{icon:n.v02}),(0,i.jsx)("span",{children:"홈으로"})]}),(0,i.jsxs)("button",{className:"profile__action",onClick:()=>{a.push("/admin")},children:[(0,i.jsx)(t.g,{icon:n.dB}),(0,i.jsx)("span",{children:"관리자"})]}),(0,i.jsxs)("button",{className:"profile__action profile__action--logout",onClick:()=>{window.confirm("로그아웃 하시겠습니까?")&&(h.y1.signOut(),a.push("/"))},children:[(0,i.jsx)(t.g,{icon:n.GxD}),(0,i.jsx)("span",{children:"로그아웃"})]})]})]})]})]})}),(0,i.jsxs)("main",{className:"post__content",children:[(0,i.jsxs)("div",{className:"post__intro-section",children:[(0,i.jsx)("div",{className:"section-toggle",children:(0,i.jsxs)("button",{className:"toggle-btn",onClick:()=>{let e=!o;m(e),localStorage.setItem("hidePostIntro",String(!e))},"aria-label":o?"소개 숨기기":"소개 보기",children:[(0,i.jsx)(t.g,{icon:n.wRm}),(0,i.jsx)("span",{children:"장소 등록이 처음이신가요?"}),(0,i.jsx)(t.g,{icon:o?n.w2A:n.Jt$})]})}),o&&(0,i.jsx)("div",{className:"post__intro",children:(0,i.jsxs)("div",{className:"intro__content",children:[(0,i.jsx)("div",{className:"intro__icon",children:(0,i.jsx)(t.g,{icon:n.QLR})}),(0,i.jsxs)("div",{className:"intro__text",children:[(0,i.jsx)("h2",{children:"제주도의 숨겨진 보석을 공유해주세요"}),(0,i.jsx)("p",{children:"당신만 아는 특별한 장소, 맛집, 카페를 다른 여행자들과 나눠보세요!"})]})]})})]}),(0,i.jsxs)("div",{className:"post__tips-section",children:[(0,i.jsx)("div",{className:"section-toggle",children:(0,i.jsxs)("button",{className:"toggle-btn",onClick:()=>{let e=!x;g(e),localStorage.setItem("hidePostTips",String(!e))},"aria-label":x?"가이드 숨기기":"가이드 보기",children:[(0,i.jsx)(t.g,{icon:n.rC2}),(0,i.jsx)("span",{children:"등록 가이드"}),(0,i.jsx)(t.g,{icon:x?n.w2A:n.Jt$})]})}),x&&(0,i.jsx)("div",{className:"post__tips",children:(0,i.jsx)(p.RC,{modules:[j.Vx,j.dK,j.Ij],spaceBetween:20,slidesPerView:1,navigation:!0,pagination:{clickable:!0},autoplay:{delay:4e3,disableOnInteraction:!1},breakpoints:{640:{slidesPerView:2},1024:{slidesPerView:3}},className:"tips__swiper",children:N.map((e,s)=>(0,i.jsx)(p.qr,{children:(0,i.jsxs)("div",{className:"tip__card",children:[(0,i.jsx)("div",{className:"tip__icon",children:(0,i.jsx)(t.g,{icon:e.icon})}),(0,i.jsx)("h4",{className:"tip__title",children:e.title}),(0,i.jsx)("p",{className:"tip__description",children:e.description})]})},s))})})]}),(0,i.jsx)("div",{className:"post__form-container",children:(0,i.jsx)(u,{userObj:s})})]}),r&&(0,i.jsx)("div",{className:"profile__backdrop",onClick:()=>d(!1)})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[725,772,650,885,636,593,792],()=>s(2180)),_N_E=e.O()}]);